rect fontData[] = 
{
    {  0 * 8,  0 * 8, 3 * 8, 6 * 8 }, // 
    {  5 * 8,  0 * 8, 2 * 8, 6 * 8 }, // !
    {  7 * 8,  0 * 8, 4 * 8, 6 * 8 }, // "
    { 11 * 8,  0 * 8, 6 * 8, 6 * 8 }, // #
    { 17 * 8,  0 * 8, 5 * 8, 6 * 8 }, // $
    { 22 * 8,  0 * 8, 6 * 8, 6 * 8 }, // %
    { 28 * 8,  0 * 8, 5 * 8, 6 * 8 }, // &
    { 33 * 8,  0 * 8, 3 * 8, 6 * 8 }, // '
    { 36 * 8,  0 * 8, 3 * 8, 6 * 8 }, // (
    { 39 * 8,  0 * 8, 3 * 8, 6 * 8 }, // )
    { 42 * 8,  0 * 8, 4 * 8, 6 * 8 }, // *
    { 46 * 8,  0 * 8, 4 * 8, 6 * 8 }, // +
    { 50 * 8,  0 * 8, 3 * 8, 6 * 8 }, // '
    { 53 * 8,  0 * 8, 4 * 8, 6 * 8 }, // -
    { 57 * 8,  0 * 8, 2 * 8, 6 * 8 }, // .
    {  0 * 8,  6 * 8, 6 * 8, 6 * 8 }, // /
    {  6 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 0
    { 11 * 8,  6 * 8, 4 * 8, 6 * 8 }, // 1
    { 15 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 2
    { 20 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 3
    { 25 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 4
    { 30 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 5
    { 35 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 6
    { 40 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 7
    { 45 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 8
    { 50 * 8,  6 * 8, 5 * 8, 6 * 8 }, // 9
    { 55 * 8,  6 * 8, 4 * 8, 6 * 8 }, // :
    { 59 * 8,  6 * 8, 2 * 8, 6 * 8 }, // ;
    {  0 * 8, 12 * 8, 4 * 8, 6 * 8 }, // < 
    {  4 * 8, 12 * 8, 4 * 8, 6 * 8 }, // =
    {  8 * 8, 12 * 8, 4 * 8, 6 * 8 }, // >
    { 12 * 8, 12 * 8, 5 * 8, 6 * 8 }, // ?
    { 17 * 8, 12 * 8, 6 * 8, 6 * 8 }, // @
    { 23 * 8, 12 * 8, 5 * 8, 6 * 8 }, // A
    { 28 * 8, 12 * 8, 5 * 8, 6 * 8 }, // B
    { 33 * 8, 12 * 8, 5 * 8, 6 * 8 }, // C
    { 38 * 8, 12 * 8, 5 * 8, 6 * 8 }, // D
    { 43 * 8, 12 * 8, 5 * 8, 6 * 8 }, // E
    { 48 * 8, 12 * 8, 5 * 8, 6 * 8 }, // F
    { 53 * 8, 12 * 8, 5 * 8, 6 * 8 }, // G
    { 58 * 8, 12 * 8, 5 * 8, 6 * 8 }, // H
    {  0 * 8, 18 * 8, 4 * 8, 6 * 8 }, // I
    {  4 * 8, 18 * 8, 5 * 8, 6 * 8 }, // J
    {  9 * 8, 18 * 8, 5 * 8, 6 * 8 }, // K
    { 14 * 8, 18 * 8, 5 * 8, 6 * 8 }, // L
    { 19 * 8, 18 * 8, 6 * 8, 6 * 8 }, // M
    { 25 * 8, 18 * 8, 6 * 8, 6 * 8 }, // N
    { 31 * 8, 18 * 8, 5 * 8, 6 * 8 }, // O
    { 36 * 8, 18 * 8, 5 * 8, 6 * 8 }, // P
    { 41 * 8, 18 * 8, 5 * 8, 6 * 8 }, // Q
    { 46 * 8, 18 * 8, 5 * 8, 6 * 8 }, // R
    { 51 * 8, 18 * 8, 5 * 8, 6 * 8 }, // S
    { 56 * 8, 18 * 8, 4 * 8, 6 * 8 }, // T
    {  0 * 8, 24 * 8, 5 * 8, 6 * 8 }, // U
    {  5 * 8, 24 * 8, 6 * 8, 6 * 8 }, // V
    { 11 * 8, 24 * 8, 6 * 8, 6 * 8 }, // W
    { 17 * 8, 24 * 8, 6 * 8, 6 * 8 }, // X
    { 23 * 8, 24 * 8, 6 * 8, 6 * 8 }, // Y
    { 29 * 8, 24 * 8, 6 * 8, 6 * 8 }, // Z
    { 35 * 8, 24 * 8, 3 * 8, 6 * 8 }, // [
    { 38 * 8, 24 * 8, 6 * 8, 6 * 8 }, // \ 
    { 44 * 8, 24 * 8, 3 * 8, 6 * 8 }, // ]
    { 47 * 8, 24 * 8, 4 * 8, 6 * 8 }, // ^
    { 51 * 8, 24 * 8, 5 * 8, 6 * 8 }, // _
    { 56 * 8, 24 * 8, 3 * 8, 6 * 8 }, // `
    {  0 * 8, 30 * 8, 5 * 8, 6 * 8 }, // a
    {  5 * 8, 30 * 8, 5 * 8, 6 * 8 }, // b
    { 10 * 8, 30 * 8, 5 * 8, 6 * 8 }, // c
    { 15 * 8, 30 * 8, 5 * 8, 6 * 8 }, // d
    { 20 * 8, 30 * 8, 5 * 8, 6 * 8 }, // e
    { 25 * 8, 30 * 8, 5 * 8, 6 * 8 }, // f
    { 30 * 8, 30 * 8, 5 * 8, 6 * 8 }, // g
    { 35 * 8, 30 * 8, 5 * 8, 6 * 8 }, // h
    { 40 * 8, 30 * 8, 4 * 8, 6 * 8 }, // i
    { 44 * 8, 30 * 8, 5 * 8, 6 * 8 }, // j
    { 49 * 8, 30 * 8, 5 * 8, 6 * 8 }, // k
    { 54 * 8, 30 * 8, 5 * 8, 6 * 8 }, // l
    {  0 * 8, 36 * 8, 6 * 8, 6 * 8 }, // m
    {  6 * 8, 36 * 8, 6 * 8, 6 * 8 }, // n
    { 12 * 8, 36 * 8, 5 * 8, 6 * 8 }, // o
    { 17 * 8, 36 * 8, 5 * 8, 6 * 8 }, // p
    { 22 * 8, 36 * 8, 5 * 8, 6 * 8 }, // q
    { 27 * 8, 36 * 8, 5 * 8, 6 * 8 }, // r
    { 32 * 8, 36 * 8, 5 * 8, 6 * 8 }, // s
    { 37 * 8, 36 * 8, 4 * 8, 6 * 8 }, // t
    { 41 * 8, 36 * 8, 5 * 8, 6 * 8 }, // u
    { 45 * 8, 36 * 8, 6 * 8, 6 * 8 }, // v
    { 51 * 8, 36 * 8, 6 * 8, 6 * 8 }, // w
    {  0 * 8, 42 * 8, 6 * 8, 6 * 8 }, // x
    {  6 * 8, 42 * 8, 6 * 8, 6 * 8 }, // y
    { 12 * 8, 42 * 8, 6 * 8, 6 * 8 }, // z
    { 18 * 8, 42 * 8, 4 * 8, 6 * 8 }, // {
    { 22 * 8, 42 * 8, 2 * 8, 6 * 8 }, // |
    { 24 * 8, 42 * 8, 4 * 8, 6 * 8 }, // }
    { 28 * 8, 42 * 8, 6 * 8, 6 * 8 }, // ~
};

#define FONT_SPRITE_WIDTH_PX 512
#define FONT_SPRITE_HEIGHT_PX 512
#define FONT_LINE_HEIGHT_PX 48
#define FONT_HORIZONTAL_GAP_PX 8

#define getCharIndex(c) ((s32)((c) > 0 ? (c) - 32 : 0))

WarSprite loadFontSprite(WarContext* context)
{
    const char* fontPath = context->fontPath;

    WarSprite sprite = {0};

    s32 width, height, bitsPerPixel;
    u8* data = stbi_load(fontPath, &width, &height, &bitsPerPixel, 0);
    if (data)
    {
        sprite = createSprite(context, width, height, data);
        stbi_image_free(data);
    }

    return sprite;
}

void renderSingleText(WarContext* context, const char* text, f32 x, f32 y, NVGfontParams params)
{
    NVGcontext* gfx = context->gfx;

    if (params.fontSize <= 0)
        params.fontSize = 6.0f;

    if (!params.fontFace)
        params.fontFace = "defaultFont";

    if (params.textAlign <= 0)
        params.textAlign = NVG_ALIGN_LEFT | NVG_ALIGN_TOP;

    if (params.blur < 0)
        params.blur = 0;

    // nvgFontSize(gfx, params.fontSize);
    // nvgFontFace(gfx, params.fontFace);
    // nvgFillColor(gfx, params.fontColor);
    // nvgTextAlign(gfx, params.textAlign);
    // nvgFontBlur(gfx, params.blur);
    // nvgText(gfx, x, y, text, NULL);

    size32 len = strlen(text);
    f32 scale = params.fontSize / FONT_LINE_HEIGHT_PX;

    NVGimageBatch* batch = nvgBeginImageBatch(gfx, context->fontSprite.image, len);

    nvgSave(gfx);
    nvgScale(gfx, scale, scale);

    for (s32 i = 0; i < len; i++)
    {
        char c = text[i];

        rect rs = fontData[getCharIndex(c)];
        rect rd = rectf(x, y, rs.width, rs.height);

        if (c != ' ')
        {
#ifdef __DEBUG__
            nvgFillRect(context->gfx, rd, NVG_GREEN_SELECTION);
#endif

            nvgRenderBatchImage(gfx, batch, rs, rd, VEC2_ONE);
        }

        x += rs.width + FONT_HORIZONTAL_GAP_PX;
    }

    nvgEndImageBatch(gfx, batch);
    nvgRestore(gfx);
}
